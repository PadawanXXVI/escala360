{% extends "base.html" %}
{% block content %}

<!-- ============================================
     ESCALA360 – Gestão de Escalas e Plantões
     Autor: Anderson de Matos Guimarães
     Data: 24/10/2025
   ============================================ -->

<section>
  <!-- Cabeçalho -->
  <header class="mb-8">
    <h1 class="text-3xl font-bold text-indigo-600 dark:text-indigo-400 mb-2">
      Gestão de Escalas e Substituições
    </h1>
    <p class="text-gray-600 dark:text-gray-300 max-w-3xl">
      Consulte a escala de servidores, verifique plantões vagos e gerencie substituições em andamento.
    </p>
  </header>

  <!-- Barra de ações -->
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 gap-4">
    <div>
      <input
        type="text"
        id="searchInput"
        placeholder="Pesquisar servidor..."
        class="w-full sm:w-72 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 dark:bg-gray-800 dark:border-gray-700"
      />
    </div>

    <div class="flex gap-2">
      <button class="btn-primary">
        <i class="fas fa-user-plus mr-2"></i> Novo Plantão
      </button>
      <button class="btn-outline">
        <i class="fas fa-sync-alt mr-2"></i> Atualizar Lista
      </button>
    </div>
  </div>

  <!-- Tabela principal -->
  <div id="tabela-escalas" class="table-container card overflow-x-auto">
    <table class="min-w-full border-collapse text-sm">
      <thead>
        <tr>
          <th class="py-3 px-4 text-left text-gray-700 dark:text-gray-200">Servidor</th>
          <th class="py-3 px-4 text-left text-gray-700 dark:text-gray-200">Turno</th>
          <th class="py-3 px-4 text-left text-gray-700 dark:text-gray-200">Status</th>
          <th class="py-3 px-4 text-right text-gray-700 dark:text-gray-200">Ações</th>
        </tr>
      </thead>
      <tbody>
        <!-- Dados serão carregados dinamicamente via main.js -->
        <tr>
          <td colspan="4" class="text-center py-6 text-gray-400 dark:text-gray-500">
            Carregando dados da escala...
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal de substituição (futuro uso) -->
  <div
    id="modalSubstituicao"
    class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
  >
    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl w-full max-w-lg shadow-lg relative">
      <button
        id="closeModal"
        class="absolute top-3 right-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"
      >
        <i class="fas fa-times"></i>
      </button>
      <h2 class="text-xl font-semibold text-indigo-600 dark:text-indigo-400 mb-4">
        Sugerir Substituto
      </h2>
      <p class="text-gray-600 dark:text-gray-300 mb-4">
        Este módulo permitirá ao sistema sugerir automaticamente o melhor servidor substituto,
        considerando carga horária e disponibilidade.
      </p>
      <div class="text-right">
        <button class="btn-primary">
          <i class="fas fa-check mr-1"></i> Confirmar
        </button>
      </div>
    </div>
  </div>
</section>

<!-- Script interno para filtro de pesquisa -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const searchInput = document.getElementById("searchInput");
    const tabela = document.querySelector("#tabela-escalas tbody");

    searchInput.addEventListener("input", () => {
      const termo = searchInput.value.toLowerCase();
      const linhas = tabela.querySelectorAll("tr");
      linhas.forEach((linha) => {
        const texto = linha.textContent.toLowerCase();
        linha.style.display = texto.includes(termo) ? "" : "none";
      });
    });
  });
</script>

{% endblock %}
